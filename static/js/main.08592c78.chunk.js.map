{"version":3,"sources":["index.js"],"names":["mod","n","m","initBase","getFullDefault","usePersistentCanvas","useState","locations","setLocations","canvasRef","React","useRef","useEffect","canvas","current","width","offsetWidth","height","offsetHeight","ctx","getContext","clearRect","window","innerWidth","innerHeight","radius","circle","origX","origin","x","origY","y","strokeColor","beginPath","arc","Math","PI","lineWidth","strokeStyle","stroke","drawCircleGuide","length","bases","lastend","toggle","i","features","feat","includes","type","start","startRotation","lower","pow","zoom","zoomLevel","upper","leftCos","cos","leftSin","sin","lowerLeft","upperLeft","endRotation","end","baseString","arrowFrac","abs","rightCos","rightSin","lowerRight","midRight","upperRight","fillStyle","random_rgb","moveTo","lineTo","fill","drawFeatureLabels","name","drawFeatures","font","textAlign","locx","locy","fillText","seqName","para","purpose","split","yadjust","text","concat","drawCenter","maxAnnots","floor","circumferenceBases","inflectRadius","endRadius","triedLocs","startLoc","circleSeq","circleLoc","j","triedLoc","startX","startY","inflectX","inflectY","endX","endY","textX","textHeightMargin","textY","rendertext","slice","drawAnnotations","scenario","pointer","selection","drawPointer","activated","drawSelector","drawImage","image","poly","drawPoly","drawPlasmid","drawMaster","seed","lightener","color","prng","h","s","l","r","g","b","hue2rgb","p","q","t","toHex","hex","round","toString","hslToHex","radiusSizer","min","FileReader","root","file","genbankParser","parseTextFile","allText","rawFile","XMLHttpRequest","open","onreadystatechange","readyState","status","responseText","send","readTextFile","newCircle","newString","sequence","toUpperCase","newBases","number","loc","getCircleLocation","addedBase","letter","random","vx","vy","weight","base_image","Image","src","keywords","link","definition","annotations","getDefaultAnnotations","endmax","mousex","mousey","isZooming","zoomDirection","zoomCenter","target","locus","endBase","startBase","fontheight","max","center","spacing","startAngle","rotation","translate","rotate","resetTransform","transparency","inversion","base","fillColor","baseForceFromCircle","newBase","sign","baseNumber","basesLength","increment","zoomCircle","trigger","startenddiff","maxBasesOnZoom","zoomedMax","zoomBroker","factor","startRadius","windowContext","adder","radiff","brokerMouseDrag","event","direction","temp","tickPlasmid","radialstart","radialend","lowerlimit","upperlimit","diffx","diffy","runPoly","ReactDOM","render","timerID","setInterval","clearInterval","onresize","ref","style","border","onClick","e","onMouseMove","mouse","clientX","clientY","ydiff","xdiff","angle","sqrt","atan2","runPointer","onMouseDown","onMouseUp","display","className","console","log","onChange","clone","oldString","oldBases","updateBases","value","document","getElementById"],"mappings":"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","file":"static/js/main.08592c78.chunk.js","sourcesContent":["import ReactDOM from 'react-dom';\nimport React, { useState, createContext, useMemo, useCallback, useEffect } from 'react';\nimport './App.css'\nimport * as genbankParser from 'genbank-parser'\n\n// DECLARATION SECTION ======================================================================\nfunction mod(n, m) {\n  return ((n % m) + m) % m;\n}\n\nfunction usePersistentState() {\n  const [value, setValue] = React.useState(\n    //JSON.parse(localStorage.getItem('draw-app')) || init\n  )\n\n  React.useEffect(() => {\n    localStorage.setItem('draw-app', JSON.stringify(value))\n  })\n\n  return [value, setValue]\n}\n\nconst initBase = getFullDefault()\n\nfunction usePersistentCanvas() {\n  const [locations, setLocations] = useState(initBase);\n\n  const canvasRef = React.useRef(null)\n\n  React.useEffect(() => {\n    const canvas = canvasRef.current\n    canvas.width = canvas.offsetWidth;\n    canvas.height = canvas.offsetHeight;\n    const ctx = canvas.getContext('2d')\n    ctx.clearRect(0, 0, window.innerWidth, window.innerHeight)\n\n    drawMaster(ctx, locations)\n  })\n\n  return [locations, setLocations, canvasRef]\n}\n\nfunction init(){\n    var base_image = '';\n    //base_image.src = \"https://upload.wikimedia.org/wikipedia/commons/7/7d/Eukaryotic_RNA-polymerase_II_structure_1WCM.png\";\n    return {\n        scenario: 'fullPlasmid',\n        //scenario: fullPlasmid, arc, poly, zoom\n\n        circle:\n            {radius: radiusSizer(), origin:\n                {x:window.innerWidth*0.4, y:window.innerHeight/2}\n            },\n        //arc,\n        seqName: '',\n        link:'',\n        purpose: '',\n        bases:[],\n        baseString: '',\n        annotations:[],\n        features:[],\n        selection: {\n            pointer: null,\n            start: 0,\n            end: 0,\n            endmax: 0,\n            activated: false,\n            mousex: null,\n            mousey: null\n        },\n        zoom: {\n            zoomLevel: 1,\n            isZooming: 0,\n            zoomDirection: -1,\n            zoomCenter: 0\n        },\n        poly: {\n            x: 100,\n            y: 100,\n            target: -1\n        },\n        image: base_image\n    }\n}\n\nfunction readTextFile(file)\n{\n    var rawFile = new XMLHttpRequest();\n    var allText;\n    rawFile.open(\"GET\", file, false);\n    rawFile.onreadystatechange = function ()\n    {\n        if(rawFile.readyState === 4)\n        {\n            if(rawFile.status === 200 || rawFile.status == 0)\n            {\n                allText = rawFile.responseText;\n            }\n        }\n    }\n    rawFile.send(null);\n    return allText;\n}\n\nfunction prng(seed) {\n    var x = Math.sin(seed++) * 10000;\n    return x - Math.floor(x);\n}\n\nfunction hslToHex(h, s, l) {\n  h /= 360;\n  s /= 100;\n  l /= 100;\n  let r, g, b;\n  if (s === 0) {\n    r = g = b = l; // achromatic\n  } else {\n    const hue2rgb = (p, q, t) => {\n      if (t < 0) t += 1;\n      if (t > 1) t -= 1;\n      if (t < 1 / 6) return p + (q - p) * 6 * t;\n      if (t < 1 / 2) return q;\n      if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n      return p;\n    };\n    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    const p = 2 * l - q;\n    r = hue2rgb(p, q, h + 1 / 3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1 / 3);\n  }\n  const toHex = x => {\n    const hex = Math.round(x * 255).toString(16);\n    return hex.length === 1 ? '0' + hex : hex;\n  };\n  return `#${toHex(r)}${toHex(g)}${toHex(b)}`;\n}\n\nfunction random_rgb(seed, lightener) {\n    var color = prng(seed)\n    var hslbaseashex = hslToHex(360 * color,\n             75,\n             (85 + 10 * color) * lightener)\n    return hslbaseashex;\n}\n\nfunction radiusSizer(){\n    return Math.min(window.innerWidth/4,window.innerHeight/2.75)\n}\n\n// LOGICAL HELPERS ===============================================================================\n\nfunction loadFullChange(){\n\n}\n\nfunction loadPartialBaseChange(){\n\n}\n\nfunction stringToBases(baseString){\n\n    var temp = []\n\n    for (var i =0; i < baseString.length; i++) {\n        var base = {\n            base: baseString[i],\n            x: 100,\n            y: 100,\n            vx: 0,\n            vy: 0,\n            weight: 1\n        }\n        temp = [...temp,base]\n    }\n\n    return temp\n}\n\nfunction getDefaultBases() {\n    return 'ACCTGCGGGCCGTCTAAAAATTAAGGAAAAGCAGCAAAGGTGCATTTTTAAAATATGAAA\\n' +\n    'TGAAGATACCGCAGTACCAATTATTTTCGCAGTACAAATAATGCGCGGCCGGTGCATTTT\\n' +\n    'TCGAAAGAACGCGAGACAAACAGGACAATTAAAGTTAGTTTTTCGAGTTAGCGTGTTTGA\\n' +\n    'ATACTGCAAGATACAAGATAAATAGAGTAGTTGAAACTAGATATCAATTGCACACAAGAT\\n' +\n    'CGGCGCTAAGCATGCCACAATTTGGTATATTATGTAAAACACCACCTAAGGTGCTTGTTC\\n' +\n    'GTCAGTTTGTGGAAAGGTTTGAAAGACCTTCAGGTGAGAAAATAGCATTATGTGCTGCTG\\n' +\n    'AACTAACCTATTTATGTTGGATGATTACACATAACGGAACAGCAATCAAGAGAGCCACAT\\n' +\n    'TCATGAGCTATAATACTATCATAAGCAATTCGCTGAGTTTCGATATTGTCAATAAATCAC\\n' +\n    'TCCAGTTTAAATACAAGACGCAAAAAGCAACAATTCTGGAAGCCTCATTAAAGAAATTGA\\n' +\n    'TTCCTGCTTGGGAATTTACAATTATTCCTTACTATGGACAAAAACATCAATCTGATATCA\\n' +\n    'CTGATATTGTAAGTAGTTTGCAATTACAGTTCGAATCATCGGAAGAAGCAGATAAGGGAA\\n' +\n    'ATAGCCACAGTAAAAAAATGCTTAAAGCACTTCTAAGTGAGGGTGAAAGCATCTGGGAGA\\n' +\n    'TCACTGAGAAAATACTAAATTCGTTTGAGTATACTTCGAGATTTACAAAAACAAAAACTT\\n' +\n    'TATACCAATTCCTCTTCCTAGCTACTTTCATCAATTGTGGAAGATTCAGCGATATTAAGA\\n' +\n    'ACGTTGATCCGAAATCATTTAAATTAGTCCAAAATAAGTATCTGGGAGTAATAATCCAGT\\n' +\n    'GTTTAGTGACAGAGACAAAGACAAGCGTTAGTAGGCACATATACTTCTTTAGCGCAAGGG\\n' +\n    'GTAGGATCGATCCACTTGTATATTTGGATGAATTTTTGAGGAATTCTGAACCAGTCCTAA\\n' +\n    'AACGAGTAAATAGGACCGGCAATTCTTCAAGCAATAAACAGGAATACCAATTATTAAAAG\\n' +\n    'ATAACTTAGTCAGATCGTACAATAAAGCTTTGAAGAAAAATGCGCCTTATTCAATCTTTG\\n' +\n    'CTATAAAAAATGGCCCAAAATCTCACATTGGAAGACATTTGATGACCTCATTTCTTTCAA\\n' +\n    'TGAAGGGCCTAACGGAGTTGACTAATGTTGTGGGAAATTGGAGCGATAAGCGTGCTTCTG\\n' +\n    'CCGTGGCCAGGACAACGTATACTCATCAGATAACAGCAATACCTGATCACTACTTCGCAC\\n' +\n    'TAGTTTCTCGGTACTATGCATATGATCCAATATCAAAGGAAATGATAGCATTGAAGGATG\\n' +\n    'AGACTAATCCAATTGAGGAGTGGCAGCATATAGAACAGCTAAAGGGTAGTGCTGAAGGAA\\n' +\n    'GCATACGATACCCCGCATGGAATGGGATAATATCACAGGAGGTACTAGACTACCTTTCAT\\n' +\n    'CCTACATAAATAGACGCATATAAGTACGCATTTAAGCATAAACACGCACTATGCCGTTCT\\n' +\n    'TCTCATGTATATATATATACAGGCAACACGCAGATATAGGTGCGACGTGAACAGTGAGCT\\n' +\n    'GTATGTGCGCAGCTCGCGTTGCATTTTCGGAAGCGCTCGTTTTCGGAAACGCTTTGAAGT\\n' +\n    'TCCTATTCCGAAGTTCCTATTCTCTAGAAAGTATAGGAACTTCAGAGCGCTTTTGAAAAC\\n' +\n    'CAAAAGCGCTCTGAAGACGCACTTTCAAAAAACCAAAAACGCACCGGACTGTAACGAGCT\\n' +\n    'ACTAAAATATTGCGAATACCGCTTCCACAAACATTGCTCAAAAGTATCTCTTTGCTATAT\\n' +\n    'ATCTCTGTGCTATATCCCTATATAACCTACCCATCCACCTTTCGCTCCTTGAACTTGCAT\\n' +\n    'CTAAACTCGACCTCTACATCAACAGGCTTCCAATGCTCTTCAAATTTTACTGTCAAGTAG\\n' +\n    'ACCCATACGGCTGTAATATGCTGCTCTTCATAATGTAAGCTTATCTTTATCGAATCGTGT\\n' +\n    'GAAAAACTACTACCGCGATAAACCTTTACGGTTCCCTGAGATTGAATTAGTTCCTTTAGT\\n' +\n    'ATATGATACAAGACACTTTTGAACTTTGTACGACGAATTTTGAGGTTCGCCATCCTCTGG\\n' +\n    'CTATTTCCAATTATCCTGTCGGCTATTATCTCCGCCTCAGTTTGATCTTCCGCTTCAGAC\\n' +\n    'TGCCATTTTTCACATAATGAATCTATTTCACCCCACAATCCTTCATCCGCCTCCGCATCT\\n' +\n    'TGTTCCGTTAAACTATTGACTTCATGTTGTACATTGTTTAGTTCACGAGAAGGGTCCTCT\\n' +\n    'TCAGGCGGTAGCTCCTGATCTCCTATATGACCTTTATCCTGTTCTCTTTCCACAAACTTA\\n' +\n    'GAAATGTATTCATGAATTATGGAGCACCTAATAACATTCTTCAAGGCGGAGAAGTTTGGG\\n' +\n    'CCAGATGCCCAATATGCTTGACATGAAAACGTGAGAATGAATTTAGTATTATTGTGATAT\\n' +\n    'TCTGAGGCAATTTTATTATAATCTCGAAGATAAGAGAAGAATGCAGTGACCTTTGTATTG\\n' +\n    'ACAAATGGAGATTCCATGTATCTAAAAAATACGCCTTTAGGCCTTCTGATACCCTTTCCC\\n' +\n    'CTGCGGTTTAGCGTGCCTTTTACATTAATATCTAAACCCTCTCCGATGGTGGCCTTTAAC\\n' +\n    'TGACTAATAAATGCAACCGATATAAACTGTGATAATTCTGGGTGATTTATGATTCGATCG\\n' +\n    'ACAATTGTATTGTACACTAGTGCAGGATCAGGCCAATCCAGTTCTTTTTCAATTACCGGT\\n' +\n    'GTGTCGTCTGTATTCAGTACATGTCCAACAAATGCAAATGCTAACGTTTTGTATTTCTTA\\n' +\n    'TAATTGTCAGGAACTGGAAAAGTCCCCCTTGTCGTCTCGATTACACACCTACTTTCATCG\\n' +\n    'TACACCATAGGTTGGAAGTGCTGCATAATACATTGCTTAATACAAGCAAGCAGTCTCTCG\\n' +\n    'CCATTCATATTTCAGTTATTTTCCATTACAGCTGATGTCATTGTATATCAGCGCTGTAAA\\n' +\n    'AATCTATCTGTTACAGAAGGTTTTCGCGGTTTTTATAAACAAAACTTTCGTTACGAAATC\\n' +\n    'GAGCAATCACCCCAGCTGCGTATTTGGAAATTCGGGAAAAAGTAGAGCAACGCGAGTTGC\\n' +\n    'ATTTTTTACACCATAATGCATGATTAACTTCGAGAAGGGATTAAGGCTAATTTCACTAGT\\n' +\n    'ATGTTTCAAAAACCTCAATCTGTCCATTGAATGCCTTATAAAACAGCTATAGATTGCATA\\n' +\n    'GAAGAGTTAGCTACTCAATGCTTTTTGTCAAAGCTTACTGATGATGATGTGTCTACTTTC\\n' +\n    'AGGCGGGTCTGTAGTAAGGAGAATGACATTATAAAGCTGGCACTTAGAATTCCACGGACT\\n' +\n    'ATAGACTATACTAGTATACTCCGTCTACTGTACGATACACTTCCGCTCAGGTCCTTGTCC\\n' +\n    'TTTAACGAGGCCTTACCACTCTTTTGTTACTCTATTGATCCAGCTCAGCAAAGGCAGTGT\\n' +\n    'GATCTAAGATTCTATCTTCGCGATGTAGTAAAACTAGCTAGACCGAGAAAGAGACTAGAA\\n' +\n    'ATGCAAAAGGCACTTCTACAATGGCTGCCATCATTATTATCCGATGTGACGCTGCAGCTT\\n' +\n    'CTCAATGATATTCGAATACGCTTTGAGGAGATACAGCCTAATATCCGACAAACTGTTTTA\\n' +\n    'CAGATTTACGATCGTACTTGTTACCCATCATTGAATTTTGAACATCCGAACCTGGGAGTT\\n' +\n    'TTCCCTGAAACAGATAGTATATTTGAACCTGTATAATAATATATAGTCTAGCGCTTTACG\\n' +\n    'GAAGACAATGTATGTATTTCGGTTCCTGGAGAAACTATTGCATCTATTGCATAGGTAATC\\n' +\n    'TTGCACGTCGCATCCCCGGTTCATTTTCTGCGTTTCCATCTTGCACTTCAATAGCATATC\\n' +\n    'TTTGTTAACGAAGCATCTGTGCTTCATTTTGTAGAACAAAAATGCAACGCGAGAGCGCTA\\n' +\n    'ATTTTTCAAACAAAGAATCTGAGCTGCATTTTTACAGAACAGAAATGCAACGCGAAAGCG\\n' +\n    'CTATTTTACCAACGAAGAATCTGTGCTTCATTTTTGTAAAACAAAAATGCAACGCGAGAG\\n' +\n    'CGCTAATTTTTCAAACAAAGAATCTGAGCTGCATTTTTACAGAACAGAAATGCAACGCGA\\n' +\n    'GAGCGCTATTTTACCAACAAAGAATCTATACTTCTTTTTTGTTCTACAAAAATGCATCCC\\n' +\n    'GAGAGCGCTATTTTTCTAACAAAGCATCTTAGATTACTTTTTTTCTCCTTTGTGCGCTCT\\n' +\n    'ATAATGCAGTCTCTTGATAACTTTTTGCACTGTAGGTCCGTTAAGGTTAGAAGAAGGCTA\\n' +\n    'CTTTGGTGTCTATTTTCTCTTCCATAAAAAAAGCCTGACTCCACTTCCCGCGTTTACTGA\\n' +\n    'TTACTAGCGAAGCTGCGGGTGCATTTTTTCAAGATAAAGGCATCCCCGATTATATTCTAT\\n' +\n    'ACCGATGTGGATTGCGCATACTTTGTGAACAGAAAGTGATAGCGTTGATGATTCTTCATT\\n' +\n    'GGTCAGAAAATTATGAACGGTTTCTTCTATTTTGTCTCTATATACTACGTATAGGAAATG\\n' +\n    'TTTACATTTTCGTATTGTTTTCGATTCACTCTATGAATAGTTCTTACTACAATTTTTTTG\\n' +\n    'TCTAAAGAGTAATACTAGAGATAAACATAAAAAATGTAGAGGTCGAGTTTAGATGCAAGT\\n' +\n    'TCAAGGAGCGAAAGGTGGATGGGTAGGTTATATAGGGATATAGCACAGAGATATATAGCA\\n' +\n    'AAGAGATACTTTTGAGCAATGTTTGTGGAAGCGGTATTCGCAATATTTTAGTAGCTCGTT\\n' +\n    'ACAGTCCGGTGCGTTTTTGGTTTTTTGAAAGTGCGTCTTCAGAGCGCTTTTGGTTTTCAA\\n' +\n    'AAGCGCTCTGAAGTTCCTATACTTTCTAGAGAATAGGAACTTCGGAATAGGAACTTCAAA\\n' +\n    'GCGTTTCCGAAAACGAGCGCTTCCGAAAATGCAACGCGAGCTGCGCACATACAGCTCACT\\n' +\n    'GTTCACGTCGCACCTATATCTGCGTGTTGCCTGTATATATATATACATGAGAAGAACGGC\\n' +\n    'ATAGTGCGTGTTTATGCTTAAATGCGTACTTATATGCGTCTATTTATGTAGGATGAAAGG\\n' +\n    'TAGTCTAGTACCTCCTGTGATATTATCCCATTCCATGCGGGGTATCGTATGCTTCCTTCA\\n' +\n    'GCACTACCCTTTAGCTGTTCTATATGCTGCCACTCCTCAATTGGATTAGTCTCATCCTTC\\n' +\n    'AATGCTATCATTTCCTTTGATATTGGATCATACCCTAGAAGTATTACGTGATTTTCTGCC\\n' +\n    'CCTTACCCTCGTTGCTACTCTCCTTTTTTTCGTGGGAACCGCTTTAGGGCCCTCAGTGAT\\n' +\n    'GGTGTTTTGTAATTTATATGCTCCTCTTGCATTTGTGTCTCTACTTCTTGTTCGCCTGGA\\n' +\n    'GGGAACTTCTTCATTTGTATTAGCATGGTTCACTTCAGTCCTTCCTTCCAACTCACTCTT\\n' +\n    'TTTTTGCTGTAAACGATTCTCTGCCGCCAGTTCATTGAAACTATTGAATATATCCTTTAG\\n' +\n    'AGATTCCGGGATGAATAAATCACCTATTAAAGCAGCTTGACGATCTGGTGGAACTAAAGT\\n' +\n    'AAGCAATTGGGTAACGACGCTTACGAGCTTCATAACATCTTCTTCCGTTGGAGCTGGTGG\\n' +\n    'GACTAATAACTGTGTACAATCCATTTTTCTCATGAGCATTTCGGTAGCTCTCTTCTTGTC\\n' +\n    'TTTCTCGGGCAATCTTCCTATTATTATAGCAATAGATTTGTATAGTTGCTTTCTATTGTC\\n' +\n    'TAACAGCTTGTTATTCTGTAGCATCAAATCTATGGCAGCCTGACTTGCTTCTTGTGAAGA\\n' +\n    'GAGCATACCATTTCCAATCGAATCAAACCTTTCCTTAACCATCTTCGCAGCAGGCAAAAT\\n' +\n    'TACCTCAGCACTGGAGTCAGAAGATACGCTGGAATCTTCTGCGCTAGAATCAAGACCATA\\n' +\n    'CGGCCTACCGGTTGTGAGAGATTCCATGGGCCTTATGACATATCCTGGAAAGAGTAGCTC\\n' +\n    'ATCAGACTTACGTTTACTCTCTATATCAATATCTACATCAGGAGCAATCATTTCAATAAA\\n' +\n    'CAGCCGACATACATCCCAGACGCTATAAGCTGTACGTGCTTTTACCGTCAGATTCTTGGC\\n' +\n    'TGTTTCAATGTCGTCCATTTTGGTTTTCTTTTACCAGTATTGTTCGTTTGATAATGTATT\\n' +\n    'CTTGCTTATTACATTATAAAATCTGTGCAGATCACATGTCAAAACAACTTTTTATCACAA\\n' +\n    'GATAGTACCGCAAAACGA'\n}\n\nfunction parseTextFile(file){\n    var parsedFile = genbankParser(file)\n    return parsedFile\n}\n\nfunction getFullDefault() {\n    var reader = new FileReader();\n    var genbank = ''\n    var result = ''\n    var file = parseTextFile(readTextFile('https://media.addgene.org/snapgene-media/v1.6.2-0-g4b4ed87/sequences/75/11/267511/addgene-plasmid-18916-sequence-267511.gbk'))\n    var root = file[0]\n\n    var newCircle = {radius: radiusSizer(), origin:\n                {x:window.innerWidth*0.4, y:window.innerHeight/2}\n        }\n\n    var newString = root.sequence.toUpperCase()\n    var newBases = []\n    for (var i=0; i < newString.length; i++) {\n        var number = i\n        var loc = getCircleLocation(number, newString.length, newCircle)\n        var addedBase = {\n            number: number,\n            letter: newString[i],\n            x: loc.x + (Math.random() - 0.5) * 100,\n            y: loc.y + (Math.random() - 0.5) * 100,\n            vx: 0,\n            vy: 0,\n            weight: 1\n        }\n        newBases = [...newBases, addedBase]\n    }\n\n    var base_image = new Image();\n    base_image.src = \"https://upload.wikimedia.org/wikipedia/commons/7/7d/Eukaryotic_RNA-polymerase_II_structure_1WCM.png\";\n\n    var newLocations = {\n        scenario: 'fullPlasmid',\n        circle: newCircle,\n        seqName:root.keywords,\n        link: 'https://www.addgene.org/60957/',\n        purpose: root.definition,\n        bases:newBases,\n        baseString: newString,\n        annotations:getDefaultAnnotations(),\n        features:root.features,\n        selection: {\n            start: Math.PI * (-0.4),\n            end: Math.PI * (-0.6),\n            endmax: Math.PI * (-0.6),\n            activated: false,\n            mousex: null,\n            mousey: null\n        },\n        zoom: {\n            pointer: null,\n            zoomLevel: 1,\n            isZooming: 0,\n            zoomDirection: -1,\n            zoomCenter: 0\n        },\n        poly: {\n            x: 100,\n            y: 100,\n            target: -1\n        },\n        image: base_image\n    }\n\n    return newLocations\n}\n\nfunction getDefaultFeatures(){\n    var features = [\n        {\n            name: 'Cas9',\n            start: 0,\n            end: 2735,\n            color: '#e39bbf'\n        },\n        {\n            name: 'EcoR1',\n            start: 2736,\n            end: 4023,\n            color: '#87bbdc'\n        },\n        {\n            name: 'TANF',\n            start: 4324,\n            end: 4978,\n            color: '#f5c1a0'\n        }\n    ]\n    return features\n}\n\nfunction getDefaultAnnotations(){\n    var anns = [\n        {\n            name: 'Waldo',\n            locus: 1232\n        },\n        {\n            name: 'Wanda',\n            locus: 23\n        },\n        {\n            name: 'Aries',\n            locus: 24\n        }\n    ]\n    return anns\n}\n\nfunction updateBases(newString, oldString, oldBases, circle) {\n    // need to handle base insertion or deletion later on\n    var newBases = oldBases\n\n    for (var i=0; i < (newString.length - oldString.length); i++) {\n        var number = oldBases.length + i\n        var loc = getCircleLocation(number, newString.length, circle)\n        var addedBase = {\n            number: number,\n            letter: newString[oldBases.length + i],\n            x: loc.x + (Math.random() - 0.5) * 100,\n            y: loc.y + (Math.random() - 0.5) * 100,\n            vx: 0,\n            vy: 0,\n            weight: 1\n        }\n        newBases = [...newBases, addedBase]\n    }\n\n    return newBases\n}\n\n// DRAWING SECTION ======================================================================\n\nfunction drawMaster(ctx,locations) {\n\n    drawCircleGuide(ctx, locations)\n    drawFeatures(ctx, locations)\n    drawCenter(ctx, locations)\n    drawAnnotations(ctx, locations)\n\n    if (locations.scenario === 'fullPlasmid') {\n\n        drawPointer(ctx, locations)\n        if(locations.selection.activated == true){\n            drawSelector(ctx, locations)\n        }\n    } else if (locations.scenario === 'poly') {\n        drawPoly(ctx, locations)\n        drawPlasmid(ctx, locations)\n        // drawRNAPol(ctx,locations)\n        // drawMRNA(ctx,locations)\n        // drawRibosome(ctx,locations)\n        // drawAminos(ctx,locations)\n        // drawProtein(ctx,locations)\n    } else if (locations.scenario === 'arc') {\n        drawPlasmid(ctx, locations)\n        // drawArc(ctx,locations)\n        // drawArcBases(ctx,locations)\n    } else if (locations.scenario === 'zoom') {\n        drawPlasmid(ctx, locations)\n        // drawCircleGuide(ctx,locations)\n        // drawPlasmid(ctx,locations)\n        // drawArc(ctx,locations)\n        // drawArcBases(ctx,locations)\n    }\n}\n\nfunction drawSelector(ctx, locations) {\n    var start = locations.selection.start\n    var pointer = locations.selection.pointer\n\n    var baseMax = 1000\n    var max = Math.PI * 2 * baseMax / locations.bases.length\n\n    ctx.strokeStyle = 'rgba(95,154,220,0.75)'\n    //draw start\n    var upper = 1.2\n    var lower = 0.8\n\n    ctx.beginPath();\n    ctx.moveTo(Math.cos(start) * locations.circle.radius * lower + locations.circle.origin.x,\n        Math.sin(start) * locations.circle.radius * lower + locations.circle.origin.y)\n    ctx.lineTo(Math.cos(start) * locations.circle.radius * upper + locations.circle.origin.x,\n        Math.sin(start) * locations.circle.radius * upper + locations.circle.origin.y)\n    ctx.stroke();\n\n    //draw max\n\n    //draw selection highlight\n\n    var radius = locations.circle.radius\n    var origin = locations.circle.origin\n\n    var upperLeft = {x: Math.cos(start) * locations.circle.radius * upper + locations.circle.origin.x,\n        y: Math.sin(start) * locations.circle.radius * upper + locations.circle.origin.y}\n    var lowerLeft = {x: Math.cos(start) * locations.circle.radius * lower + locations.circle.origin.x,\n        y: Math.sin(start) * locations.circle.radius * lower + locations.circle.origin.y}\n    var upperRight = {x: Math.cos(pointer) * locations.circle.radius * upper + locations.circle.origin.x,\n        y: Math.sin(pointer) * locations.circle.radius * upper + locations.circle.origin.y}\n    var lowerRight = {x: Math.cos(pointer) * locations.circle.radius * lower + locations.circle.origin.x,\n        y: Math.sin(pointer) * locations.circle.radius * lower + locations.circle.origin.y}\n\n    ctx.fillStyle = 'rgba(95,154,220,0.5)'\n    ctx.beginPath()\n    ctx.moveTo(upperLeft.x, upperLeft.y)\n    ctx.lineTo(lowerLeft.x, lowerLeft.y)\n    if (((pointer - start > 0) && (pointer - start < Math.PI)) ||\n        ((Math.abs(pointer - start) > Math.PI) && (pointer - start < 0))\n    ){\n        ctx.arc(origin.x, origin.y, radius * upper, start, pointer, false)\n        ctx.lineTo(upperRight.x, upperRight.y)\n        ctx.lineTo(lowerRight.x, lowerRight.y)\n        ctx.arc(origin.x, origin.y, radius * lower, pointer, start, true)\n    } else {\n        ctx.arc(origin.x, origin.y, radius * upper, pointer, start, false)\n        ctx.lineTo(lowerRight.x, lowerRight.y)\n        ctx.lineTo(upperRight.x, upperRight.y)\n        ctx.arc(origin.x, origin.y, radius * lower, start, pointer, true)\n    }\n\n    ctx.fill()\n\n    //draw excess highlight\n\n}\n\nfunction drawPointer(ctx, locations){\n    var pointer = locations.selection.pointer\n    ctx.beginPath();\n    ctx.strokeStyle = 'rgb(68,68,68)'\n    ctx.moveTo(Math.cos(pointer) * locations.circle.radius * 0.8 + locations.circle.origin.x,\n        Math.sin(pointer) * locations.circle.radius * 0.8 + locations.circle.origin.y)\n    ctx.lineTo(Math.cos(pointer) * locations.circle.radius * 1.2 + locations.circle.origin.x,\n        Math.sin(pointer) * locations.circle.radius * 1.2 + locations.circle.origin.y)\n    ctx.stroke();\n}\n\nfunction drawPoly(ctx, locations){\n    ctx.drawImage(locations.image, locations.poly.x-50,locations.poly.y-125,window.innerWidth/6,window.innerWidth/6)\n\n}\n\nfunction drawCenter(ctx, locations) {\n    ctx.font = '24px Arial'\n    ctx.textAlign = 'center'\n    var locx = locations.circle.origin.x\n    var locy = locations.circle.origin.y\n    ctx.fillStyle = \"black\";\n    ctx.fillText(locations.seqName, locx, locy - 40)\n    ctx.font = '18px Arial'\n    var para = locations.purpose.split(' ')\n    var inc = 50\n    var yadjust = 0;\n    var text = '';\n    for (var i = 0; i < para.length; i++){\n        var text = text.concat(para[i], ' ')\n        if ((text.length > inc) || (i == para.length -1)) {\n            ctx.fillText(text, locx, locy + yadjust)\n            yadjust += 25;\n            text = '';\n        }\n    }\n}\n\nfunction drawFeatures(ctx, locations){\n    var radius = locations.circle.radius - 50;\n    var origin = locations.circle.origin\n    var length = locations.bases.length\n    if (length === 0){\n        length = 1\n    }\n\n    var lastend = 0;\n    var toggle = 0;\n    var radchange = 0.85;\n\n    for (var i = 0; i<locations.features.length; i++) {\n        var feat = locations.features[i]\n        if ((!['promoter','enhancer','misc_RNA','CDS','polyA_signal','rep_origin', 'repeat_region'].includes(feat.type))) {\n            continue\n        }\n        if (feat.start < lastend){\n            radius *= radchange\n            toggle = 1\n        }\n        var startRotation = Math.PI*2*feat.start/length\n        var lower = Math.pow(0.95, (1/locations.zoom.zoomLevel))\n        var upper = Math.pow(1.05, (1/locations.zoom.zoomLevel))\n        var leftCos = Math.cos(startRotation)\n        var leftSin = Math.sin(startRotation)\n        var lowerLeft = {\n            x: leftCos * radius * lower + origin.x,\n            y: leftSin * radius * lower + origin.y\n        }\n        var upperLeft = {\n            x: leftCos * radius * upper + origin.x,\n            y: leftSin * radius * upper + origin.y\n        }\n\n        var endRotation = Math.PI*2*feat.end/locations.baseString.length\n        var arrowFrac = 2*Math.PI * (1/150)/locations.zoom.zoomLevel\n        if (Math.abs(startRotation - endRotation) < 0.25) {\n            arrowFrac = Math.abs(startRotation - endRotation) * 0.2\n        }\n\n        var rightCos = Math.cos(endRotation - arrowFrac)\n        var rightSin = Math.sin(endRotation - arrowFrac)\n        var lowerRight = {\n            x: rightCos * radius * lower + origin.x,\n            y: rightSin * radius * lower + origin.y\n        }\n\n        var midRight = {\n            x: Math.cos(endRotation) * radius + origin.x,\n            y: Math.sin(endRotation) * radius + origin.y\n        }\n\n        var upperRight = {\n            x: rightCos * radius * upper + origin.x,\n            y: rightSin * radius * upper + origin.y\n        }\n\n        ctx.fillStyle = random_rgb(feat.end / feat.start, 0.9)\n        ctx.beginPath()\n        ctx.moveTo(upperLeft.x, upperLeft.y)\n        ctx.lineTo(lowerLeft.x, lowerLeft.y)\n        ctx.arc(origin.x, origin.y, radius * upper, startRotation, endRotation - arrowFrac, false)\n        ctx.lineTo(upperRight.x, upperRight.y)\n        ctx.lineTo(midRight.x, midRight.y)\n        ctx.lineTo(lowerRight.x, lowerRight.y)\n        ctx.arc(origin.x, origin.y, radius * lower, endRotation - arrowFrac, startRotation, true)\n        ctx.fill()\n\n        ctx.strokeStyle = random_rgb(feat.end / feat.start, 0.8)\n        //ctx.strokeStyle = random_rgb(feat.end / feat.start)\n        ctx.stroke()\n\n        drawFeatureLabels(ctx, feat.name, radius, origin , startRotation, endRotation, lower, upper, feat.end, feat.start)\n\n        if((toggle == 1) && (locations.features[mod(i+1,locations.features.length)].start > lastend)){\n            radius *= (1/radchange)\n            toggle = 0\n        } else if (toggle == 0) {\n            lastend = feat.end\n        }\n    }\n}\n\nfunction drawFeatureLabels(ctx, name, radius, origin, start, end, lower, upper, endBase, startBase){\n    var fontheight = Math.max(Math.min((upper - lower)*radius/2,18),10)\n    var namelen = name.length * fontheight * 3.5\n    var textwidth = radius * (end - start) * 2 * Math.PI\n    if (namelen >= textwidth){\n        return;\n    }\n    ctx.fillStyle = 'black'\n    ctx.textAlign = \"center\"\n    var circumference = Math.PI * 2 * radius\n    var center = (end + start)/2\n    var textcolor = 'rgb(64,64,64)'\n    for (var i = 0; i < name.length; i++){\n        var spacing = (lower + (upper - lower)/3)\n        var startAngle = center - fontheight * 3.5 * (name.length/2 - i) / (2 * Math.PI * radius)\n        var rotation = startAngle + 0.5 * Math.PI\n        var letter = name[i]\n        var spacer2 = 0;\n        if (rotation > 0.5*Math.PI && rotation < 1.5 * Math.PI){\n            rotation += Math.PI\n            letter = name[name.length - i - 1]\n            spacing = (lower + (upper - lower)*2/3)\n        }\n        var x = origin.x + radius * Math.cos(startAngle) * spacing\n        var y = origin.y + radius * Math.sin(startAngle) * spacing\n        ctx.translate(x,y)\n        ctx.rotate(rotation)\n        ctx.fillStyle = textcolor\n        ctx.font = fontheight + 'px Andale Mono'\n        ctx.fillText(letter, 0, 0)\n        ctx.resetTransform();\n    }\n}\n\nfunction drawAnnotations(ctx, locations){\n    var circle = locations.circle\n    var origin = circle.origin\n    var textHeightMargin = 20\n    var maxAnnots = Math.floor(circle.radius * 4/textHeightMargin)\n    var circumferenceBases = locations.bases.length\n    var inflectRadius = circle.radius + 25\n    var endRadius = circle.radius + 75\n    var triedLocs = []\n    for (var i = 0; i<locations.features.length; i++) {\n        var feat = locations.features[i]\n        var startLoc = (feat.start/circumferenceBases) * Math.PI * 2\n        var circleSeq = (Math.floor((feat.start/circumferenceBases)*maxAnnots))\n        var idealSeq = circleSeq\n        if ((['promoter', 'enhancer', 'misc_RNA', 'CDS', 'polyA_signal', 'rep_origin', 'repeat_region'].includes(feat.type))) {\n            continue\n        }\n        // var asinArg = circleSeq * textHeightMargin/circle.radius\n        // var adder = 0\n        //\n        ctx.textAlign = 'left'\n        // if ((asinArg > 1) && (asinArg < 3)){\n        //     asinArg = asinArg - 2\n        //     adder += Math.PI\n        //     ctx.textAlign = 'right'\n        // } else if (asinArg > 3) {\n        //     asinArg = asinArg -4\n        //     adder -= 0\n        //     ctx.textAlign = 'left'\n        // }\n        var closeLoc = Math.PI * 2 * circleSeq / maxAnnots\n        var circleLoc = startLoc\n\n\n        for (var j = 0; j < triedLocs.length; j++){\n            var triedLoc = triedLocs[j]\n            var dist = Math.abs(Math.sin(circleLoc) - Math.sin(triedLoc)) * maxAnnots /2\n            if (dist < 1){\n                circleLoc += Math.PI * 2 / maxAnnots\n            }\n        }\n\n        if ((circleLoc > 0.5*Math.PI) && (circleLoc < 1.5 * Math.PI)){\n            ctx.textAlign = 'right'\n        }\n        ctx.beginPath()\n        ctx.strokeStyle = 'rgb(139,139,139)'\n\n        var startX = Math.cos(startLoc) * circle.radius + origin.x\n        var startY = Math.sin(startLoc) * circle.radius + origin.y\n        ctx.moveTo(startX, startY)\n\n        var inflectX = Math.cos(startLoc) * inflectRadius + origin.x\n        var inflectY = Math.sin(startLoc) * inflectRadius + origin.y\n        ctx.lineTo(inflectX, inflectY)\n\n        var endX = Math.cos(circleLoc) * endRadius + origin.x\n        var endY = Math.sin(circleLoc) * endRadius + origin.y\n        ctx.lineTo(endX, endY)\n        ctx.stroke()\n\n        var textX = Math.cos(circleLoc) * (endRadius + textHeightMargin/2) + origin.x\n        var textY = Math.sin(circleLoc) * (endRadius + textHeightMargin/2) + origin.y + textHeightMargin / 4\n\n        ctx.font = '12px Arial'\n        var rendertext = feat.name\n        if (rendertext.includes('Kozak') || rendertext.includes('kozak')) {\n            rendertext = 'Kozak sequence'\n        } else if (rendertext.length > 30) {\n            rendertext = rendertext.slice(0,30) + '...'\n        }\n        ctx.fillText(rendertext, textX, textY)\n\n        triedLocs = [...triedLocs, circleLoc]\n        if (triedLocs.length === maxAnnots){\n            break\n        }\n    }\n}\n\nfunction drawCircleGuide(ctx,locations){\n\n    var radius = locations.circle.radius\n    var origX = locations.circle.origin.x\n    var origY = locations.circle.origin.y\n\n    var transparency = 1 //Math.pow(1/locations.zoom.zoomLevel,0.5)\n\n    var strokeColor = `rgba(64,64,64,${transparency})`\n\n    ctx.beginPath();\n    ctx.arc(origX, origY, radius, 0, 2 * Math.PI, false);\n    ctx.lineWidth = 2;\n    ctx.strokeStyle = strokeColor;\n    ctx.stroke();\n\n}\n\nfunction drawPlasmid(ctx,locations) {\n    var start = Math.floor(((locations.selection.start)/(Math.PI*2))*locations.bases.length)\n    var end = Math.floor(((locations.selection.end)/(Math.PI*2))*locations.bases.length)\n\n    var transparency = 1-Math.pow(1/locations.zoom.zoomLevel,0.5)\n    var strokeColor = `rgba(160,160,160,${transparency})`\n    //a = 'rgb(201,161,92)'\n    var inversion = false\n    if (((locations.selection.start - locations.selection.end > Math.PI) && (locations.selection.start > 1.5*Math.PI)) ||\n            ((locations.selection.start - locations.selection.end < -Math.PI) && (locations.selection.start < 0.5*Math.PI))){\n        var inversion = true\n    }\n    if(inversion === false) {\n        for (var i = start; i < end; i++) {\n\n            var base = locations.bases[i]\n            var base2 = locations.bases[mod(i + 1, locations.bases.length)]\n\n            ctx.beginPath()\n            ctx.arc(base.x, base.y, base.weight * locations.zoom.zoomLevel / 10, 0, 2 * Math.PI, false);\n            ctx.lineWidth = 2;\n            ctx.strokeStyle = strokeColor;\n            var fillColor = ''\n            if (base.letter === 'A') {\n                fillColor = `rgba(91,183,248,${transparency})`\n            } else if (base.letter === 'C') {\n                fillColor = `rgba(201,161,92,${transparency})`\n            } else if (base.letter === 'G') {\n                fillColor = `rgba(19,153,23,${transparency})`\n            } else if (base.letter === 'T') {\n                fillColor = `rgba(227,111,111,${transparency})`\n            } else {\n                fillColor = `rgba(255,255,255,${transparency})`\n            }\n            ctx.fillStyle = fillColor\n            ctx.stroke();\n            ctx.font = '24px Arial'\n            ctx.textAlign = 'center'\n            ctx.fillText(base.letter, base.x, base.y + 8)\n        }\n    } else if (start > end) {\n        for (var i = start; i < locations.bases.length + end; i++) {\n\n            var base = locations.bases[mod(i, locations.bases.length)]\n            var base2 = locations.bases[mod(i + 1, locations.bases.length)]\n\n            ctx.beginPath()\n            ctx.arc(base.x, base.y, base.weight * locations.zoom.zoomLevel / 10, 0, 2 * Math.PI, false);\n            ctx.lineWidth = 2;\n            ctx.strokeStyle = strokeColor;\n            var fillColor = ''\n            if (base.letter === 'A') {\n                fillColor = `rgba(91,183,248,${transparency})`\n            } else if (base.letter === 'C') {\n                fillColor = `rgba(201,161,92,${transparency})`\n            } else if (base.letter === 'G') {\n                fillColor = `rgba(19,153,23,${transparency})`\n            } else if (base.letter === 'T') {\n                fillColor = `rgba(227,111,111,${transparency})`\n            } else {\n                fillColor = `rgba(255,255,255,${transparency})`\n            }\n            ctx.fillStyle = fillColor\n            ctx.stroke();\n            ctx.font = '24px Arial'\n            ctx.textAlign = 'center'\n            ctx.fillText(base.letter, base.x, base.y + 8)\n        }\n    } else {\n        for (var i = start + locations.bases.length; i > end; i--) {\n            var base = locations.bases[mod(i, locations.bases.length)]\n            var base2 = locations.bases[mod(i + 1, locations.bases.length)]\n\n            ctx.beginPath()\n            ctx.arc(base.x, base.y, base.weight * locations.zoom.zoomLevel / 10, 0, 2 * Math.PI, false);\n            ctx.lineWidth = 2;\n            ctx.strokeStyle = strokeColor;\n            var fillColor = ''\n            if (base.letter === 'A') {\n                fillColor = `rgba(91,183,248,${transparency})`\n            } else if (base.letter === 'C') {\n                fillColor = `rgba(201,161,92,${transparency})`\n            } else if (base.letter === 'G') {\n                fillColor = `rgba(19,153,23,${transparency})`\n            } else if (base.letter === 'T') {\n                fillColor = `rgba(227,111,111,${transparency})`\n            } else {\n                fillColor = `rgba(255,255,255,${transparency})`\n            }\n            ctx.fillStyle = fillColor\n            ctx.stroke();\n            ctx.font = '24px Arial'\n            ctx.textAlign = 'center'\n            ctx.fillText(base.letter, base.x, base.y + 8)\n        }\n    }\n}\n\n// LOCATIONS AND FORCES SECTION ======================================================================\nfunction baseForceFromCircle(base, circle, length){\n    var center = getCircleLocation(base.number, length, circle)\n    var newBase = base\n\n    var damper = 3\n    if (Math.abs((center.x - newBase.x)) > 0) {\n        newBase.vx += (Math.pow(Math.abs((center.x - newBase.x)),0.5)*Math.sign(center.x - newBase.x)\n            + (Math.random()-0.5) * 10);\n    }\n\n    if (Math.abs((center.y - newBase.y)) > 0) {\n        newBase.vy += (Math.pow(Math.abs((center.y - newBase.y)),0.5)*Math.sign(center.y - newBase.y)\n            + (Math.random()-0.5) * 10);\n    }\n\n    newBase.vx *= 1/damper;\n    newBase.vy *= 1/damper;\n    newBase.x += newBase.vx\n    newBase.y += newBase.vy\n\n    return newBase\n}\n\nfunction getCircleLocation(baseNumber, basesLength, circle){\n    var increment = Math.PI * 2 / basesLength\n\n    var xval = Math.cos(increment * baseNumber) * (circle.radius + 25) + circle.origin.x\n    var yval = Math.sin(increment * baseNumber) * (circle.radius + 25) + circle.origin.y\n    return {x: xval, y: yval}\n}\n\nfunction zoomBroker(root, trigger, zoomedMax){\n    if ((root.zoom.isZooming === 0) && (trigger === true)){\n        //start zooming\n        root.zoom.zoomDirection *= -1\n        root.zoom.isZooming = 1\n        if (root.scenario === 'fullPlasmid'){\n            if(((root.selection.start - root.selection.end > Math.PI) && (root.selection.start > 1.5*Math.PI)) ||\n                ((root.selection.start - root.selection.end < -Math.PI) && (root.selection.start < 0.5*Math.PI))){\n            root.zoom.zoomCenter = (root.selection.start + root.selection.end)/2 + Math.PI} else {\n            root.zoom.zoomCenter = (root.selection.start + root.selection.end)/2\n            }\n        }\n    } else if ((root.zoom.isZooming === 1) && (\n        ((root.zoom.zoomLevel >= zoomedMax) && (root.zoom.zoomDirection === 1))\n    )){\n        //stop zooming\n        root.zoom.isZooming = 0\n        root.scenario = 'arc'\n    } else if ((root.zoom.isZooming === 1) && (\n        ((root.zoom.zoomLevel <= 1) && (root.zoom.zoomDirection === -1))\n\n    )){\n        root.zoom.isZooming = 0\n        root.scenario = 'fullPlasmid'\n    } else {\n        root.scenario = 'zoom'\n    }\n    return root\n}\n\nfunction zoomCircle(locations, trigger){\n\n    var startenddiff = (locations.selection.end) - (locations.selection.start)\n    if (startenddiff < -Math.PI){\n        startenddiff += Math.PI * 2\n    }\n    else if(((locations.selection.start - locations.selection.end > Math.PI) && (locations.selection.start > 1.5*Math.PI)) ||\n                ((locations.selection.start - locations.selection.end < -Math.PI) && (locations.selection.start < 0.5*Math.PI))){\n        startenddiff = -startenddiff + Math.PI * 2\n    }\n    var maxBasesOnZoom = Math.floor((((startenddiff)/(Math.PI*2))*locations.bases.length))\n    if(maxBasesOnZoom < 10){\n        maxBasesOnZoom = 10\n    }\n    var max = (locations.baseString.length/maxBasesOnZoom)/2\n    var root = zoomBroker(locations, trigger, max)\n    var startZoom = root.zoom.zoomLevel\n    var zoomSpeed = 1.05\n    var factor = Math.pow(zoomSpeed,root.zoom.zoomDirection)\n    var startRadius = root.circle.radius\n    root.circle.radius *= factor\n    root.zoom.zoomLevel *= factor\n    var windowContext = radiusSizer()\n    if (root.circle.radius < windowContext){\n        root.circle.radius = windowContext\n        root.zoom.zoomLevel = 1\n    } else if (root.circle.radius > (windowContext)*max) {\n        root.circle.radius = windowContext*max\n        root.zoom.zoomLevel = max\n    }\n    var adder = 0\n    var adderspeed = 5\n    if(true){\n        adder = root.zoom.zoomDirection * adderspeed\n    }\n    var radiff = root.circle.radius - startRadius + adder\n    var grow = factor\n    var center = root.zoom.zoomCenter + Math.PI\n    root.circle.origin.x += radiff * Math.cos(center)\n    root.circle.origin.y += radiff * Math.sin(center)\n    return root\n}\n\nfunction runPoly(locations, start, end){\n    var root = locations\n    var poly = root.poly\n    var scenario = root.scenario\n    if (poly.target < start){\n        poly.target = start\n        poly.x = -250\n        poly.y = -250\n        scenario = 'poly'\n    }\n    var target = root.bases[poly.target]\n    var diffx = target.x - poly.x\n    var diffy = target.y - poly.y\n    if (Math.abs(diffx+diffy) < 10){\n        root.poly.target += 1\n    } else {\n        poly.x += (diffx)/10\n        poly.y += (diffy)/10\n        if (poly.target > start) {\n            root.bases[poly.target].x -= 10\n            root.bases[poly.target].y -= 10\n            root.bases[poly.target + 1].x -= 7\n            root.bases[poly.target + 1].y -= 7\n            root.bases[poly.target + 2].x -= 4\n            root.bases[poly.target + 2].y -= 4\n        }\n    }\n    if (poly.target > end){\n        poly.target = -1\n        scenario = 'arc'\n    }\n    root = {...root, poly: poly, scenario: scenario}\n    return root\n}\n\nfunction runPointer (locations, mouse){\n    var root = locations\n    var origin = locations.circle.origin\n    var x = mouse.clientX\n    var y = mouse.clientY\n    var ydiff = y - origin.y\n    var xdiff = x - origin.x\n    var r = Math.sqrt(Math.pow(x - origin.x,2) + Math.pow(ydiff,2))\n    var angle = Math.atan2(ydiff,xdiff)\n    if (angle < 0){\n        angle += Math.PI * 2\n    }\n    var endmaxlength = 2*Math.PI/40\n    root.selection.pointer = angle\n    root.selection.mousex = x\n    root.selection.mousey = y\n    return root\n}\n\nfunction brokerMouseDrag(locations, event, direction){\n    var root = locations\n    if(direction == 'down'){\n        root.selection.activated = true\n        root.selection.start = root.selection.pointer\n    } else if (direction == 'up') {\n        root.selection.activated = false\n        root.selection.end = root.selection.pointer\n        if((root.selection.start > root.selection.end) && (root.selection.start - root.selection.end < Math.PI)) {\n            var temp = root.selection.start\n            root.selection.start = root.selection.end\n            root.selection.end = temp\n        }\n        root = zoomCircle(root, true)\n    }\n    if (locations.scenario == 'fullPlasmid'){\n\n    } else {\n        root = dragBases(root)\n    }\n    return root\n}\n\nfunction dragBases(locations){\n    var root = locations\n    return root\n}\n\n// TICKING SECTION ======================================================================\n\nfunction tickPlasmid(locations) {\n    var root = locations\n\n    if (root.zoom.isZooming === 1 ) {\n        root = zoomCircle(root, false)\n    }\n    var newBases = root.bases\n    var inversion = false\n    var radialstart = locations.selection.start\n    var radialend = locations.selection.end\n    if (((radialstart - radialend > Math.PI) && (radialstart > 1.5*Math.PI)) ||\n                ((radialstart - radialend < -Math.PI) && (radialstart < 0.5*Math.PI))){\n        var temp = radialstart\n        radialstart = radialend\n        radialend = temp\n        var inversion = true\n    }\n\n    var start = Math.floor((radialstart/(Math.PI * 2)) * locations.bases.length)\n    var end = Math.floor((radialend/(Math.PI * 2)) * locations.bases.length)\n    // if (start > end) {\n    //     var temp = start\n    //     start = end\n    //     end = temp\n    // }\n    // ((pointer - start > 0) && (pointer - start < Math.PI)) ||\n    //     ((Math.abs(pointer - start) > Math.PI) && (pointer - start < 0))\n\n    if ((root.scenario === 'arc') || (root.scenario === 'zoom') || (root.scenario === 'poly')) {\n        var lowerlimit, upperlimit\n        if (inversion === false){\n            lowerlimit = start\n            upperlimit = end\n        } else {\n            lowerlimit = end\n            upperlimit = start\n        }\n        if(inversion === false) {\n            for (var i = 0; i < root.bases.length; i++) {\n                var forcedBase = {}\n                if ((i >= lowerlimit) && (i <= upperlimit)) {\n                    newBases[i] = baseForceFromCircle(newBases[i], root.circle, root.bases.length)\n                }\n            }\n        } else {\n            for (var i = 0; i < root.bases.length; i++) {\n                var forcedBase = {}\n                if ((i <= lowerlimit) || (i >= upperlimit)) {\n                    newBases[i] = baseForceFromCircle(newBases[i], root.circle, root.bases.length)\n                }\n            }\n        }\n    }\n\n    root = {...root, bases: newBases}\n    var ticker = start\n\n    if (root.scenario === 'poly'){\n        root = runPoly(root, start, end)\n    }\n\n    return root\n}\n\n\n// HANDLER SECTION ======================================================================\n\nfunction Main() {\n    const [locations, setLocations, canvasRef] = usePersistentCanvas();\n\n    // TIMER ---------------------------------------------\n    React.useEffect(() => {\n        var timerID = setInterval(() => tickMaster(), 10);\n\n        return function cleanup() {\n\n        clearInterval(timerID);\n        };\n    })\n\n    function tickMaster() {\n        setLocations(tickPlasmid(locations))\n    }\n\n    // HANDLERS ---------------------------------------------\n\n      function handleCanvasClick(e) {\n\n      }\n\n      function handleDefault() {\n        setLocations(getFullDefault())\n      }\n\n      function handlePoly() {\n        if(locations.scenario === 'arc'){\n            setLocations({...locations, scenario:'poly'})\n        }\n      }\n\n      function handleZoom() {\n        setLocations(zoomCircle(locations, true))\n      }\n\n      function debug() {\n        console.log(locations)\n      }\n\n      function handleSeqChange(e) {\n        var clone = locations\n        clone.bases = updateBases(e.target.value, locations.baseString, locations.bases, locations.circle)\n        setLocations(clone)\n        setLocations({...locations, baseString: e.target.value})\n\n      }\n\n      function handleMouseMove(e) {\n        setLocations(runPointer(locations, e))\n      }\n\n      function handleMouseDown(e){\n        setLocations(brokerMouseDrag(locations, e, 'down'))\n      }\n\n      function handleMouseUp(e){\n        setLocations(brokerMouseDrag(locations, e, 'up'))\n      }\n\n      window.onresize = function() {\n        setLocations({...locations,\n\n          circle: {radius: radiusSizer(), origin:\n              {x:window.innerWidth*0.4, y:window.innerHeight/2}\n            }\n        })\n      }\n      ;\n\n      // RENDER JSX ---------------------------------------------\n\n      return (\n          <div>\n\n        <canvas\n            ref={canvasRef}\n            style = {{\n                width: '100vw',\n                height: '100vh',\n                border: '1px solid black'\n            }}\n            onClick={handleCanvasClick}\n            onMouseMove={handleMouseMove}\n            onMouseDown={handleMouseDown}\n            onMouseUp = {handleMouseUp}\n            display= 'inline-block'\n          />\n\n          <div className=\"controls\">\n            <button onClick={handleDefault}>Default</button>\n            <button onClick={handleZoom}>Zoom</button>\n            <button onClick={handlePoly}>Poly</button>\n            <button onClick={debug}>Debug</button>\n            <input onChange={handleSeqChange}\n            ></input></div>\n        </div>\n    )\n}\n\nReactDOM.render(\n  <Main/>,\n  document.getElementById('root')\n);"],"sourceRoot":""}